{"version":3,"sources":["webpack:///webpack/bootstrap ea6dabec5b4dcad9112b","webpack:///./client/src/bundles/LocalStorageProgressStore.js","webpack:///./~/nodelist-foreach-polyfill/index.js"],"names":["require","storageName","decodeData","encoded","JSON","parse","atob","decodeURIComponent","getQueryVariable","variable","query","window","location","search","substring","getVars","split","match","forEach","getVar","pair","decodeProgress","progress","console","warn","LocalStorageProgressStore","encodedRequestProgress","encodedLocalProgress","localStorage","getItem","requestProgress","localProgress","timestamp","setItem","loc","queryParts","item","length","param","push","origin","pathname","join","addEventListener"],"mappings":"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","file":"js/LocalStorageProgressStore.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./client/src/bundles/LocalStorageProgressStore.js\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ea6dabec5b4dcad9112b","require('nodelist-foreach-polyfill');\n\nconst storageName = '$StorageName';\n\n/**\n * @param {string} encoded\n */\nconst decodeData = (encoded) => JSON.parse(atob(decodeURIComponent(encoded)));\n\n/**\n * @param {string} variable\n * @return {mixed} The request variable's value\n */\nconst getQueryVariable = (variable) => {\n  const query = window.location.search.substring(1);\n  const getVars = query.split('&');\n  let match = false;\n\n  getVars.forEach((getVar) => {\n    const pair = getVar.split('=');\n\n    if (pair[0] === variable) {\n      match = pair[1];\n    }\n  });\n\n  return match;\n};\n\n/**\n * @param {string} progress A url encoded state of progress\n * @return {object|bool}\n */\nconst decodeProgress = (encoded) => {\n  if (!encoded) {\n    return false;\n  }\n\n  const progress = decodeData(encoded);\n\n  if (typeof progress !== 'object') {\n    // eslint-disable-next-line no-console\n    console.warn('Unexpected value supplied for decoding progress');\n\n    return false;\n  }\n\n  return progress;\n};\n\n/**\n * The default component\n */\nconst LocalStorageProgressStore = () => {\n  // This pattern uses an id and a timestamp to \"sync\" with the back end.\n  // When the request provides an encoded copy of the progress data, we verify\n  // to see if it's later than what is stored locally, before storing it.\n  // If it's not the latest, we redirect to update the request to the latest store\n\n  const encodedRequestProgress = getQueryVariable('progress');\n  const encodedLocalProgress = window.localStorage.getItem(storageName);\n\n  if (encodedRequestProgress) {\n    const requestProgress = decodeProgress(encodedRequestProgress);\n    const localProgress = decodeProgress(encodedLocalProgress);\n\n    if (!localProgress || requestProgress.timestamp >= localProgress.timestamp) {\n      // Sync down the latest store\n      window.localStorage.setItem(storageName, encodedRequestProgress);\n\n      // Nothing else to do\n      return;\n    }\n  }\n\n  if (!encodedLocalProgress) {\n    // Nothing to do\n    return;\n  }\n\n  // We want to update the user with the latest\n  // Let's swap out the ?progress param as safely as we can\n  const loc = window.location;\n  const queryParts = [];\n\n  // Use substring to remove the leading '?'\n  loc.search.substring(1).split('&').forEach((item) => {\n    if (!item.length) {\n      return;\n    }\n\n    const param = item.split('=');\n\n    if (param[0] === 'progress') {\n      // Skip, so we can rewrite this param below\n      return;\n    }\n\n    queryParts.push(item);\n  });\n\n  // Add our own progress param\n  queryParts.push(`progress=${encodedLocalProgress}`);\n\n  // Redirect to the latest store\n  window.location = [loc.origin, loc.pathname, '?', queryParts.join('&')].join('');\n};\n\nwindow.addEventListener('load', () => {\n  // Instantiate component\n  LocalStorageProgressStore();\n});\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/bundles/LocalStorageProgressStore.js","if (window.NodeList && !NodeList.prototype.forEach) {\r\n    NodeList.prototype.forEach = function (callback, thisArg) {\r\n        thisArg = thisArg || window;\r\n        for (var i = 0; i < this.length; i++) {\r\n            callback.call(thisArg, this[i], i, this);\r\n        }\r\n    };\r\n}\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/nodelist-foreach-polyfill/index.js\n// module id = ./node_modules/nodelist-foreach-polyfill/index.js\n// module chunks = 0 1"],"sourceRoot":""}